"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const y=require("./runtime-dom.esm-bundler-pS1WmCCX.cjs"),b=()=>({set:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}),v=async()=>({f:{name:e=>`${e.name}${e.id}`}}),k=async()=>({set:async e=>{console.log("--theme");try{if(!e.el_id)throw new Error("[el_id] is required");const t=e.name,r=document.getElementById(e.el_id);if(!r)throw new Error("[el_id] is invalid");(l=>{const i=s=>{(d=>{const o=d.getAttribute("data-ce");if(!o)return;const m=JSON.parse(o).filter(n=>n?.k.startsWith("t-"));if(m.length!=0)for(const n of m){const a=n.k,f=n.v.split(" ");if(a==`t-${t}-class`)for(const c of f)d.classList.add(c);else for(const c of f)d.classList.remove(c)}})(s)};for(const s of l.getElementsByTagName("*"))i(s);i(l)})(r)}catch(t){const r=`err: [theme] ${t}`;throw console.log(r),r}}});function x(e,t=1e3){let r={cnt:0};return new Promise(l=>{const i=()=>{console.log(`[setInterval] is running.. [count=${r.cnt}]`);try{e()&&(clearInterval(s),l())}catch{console.log(`warn: [wait_until] ignoring the exception in setInterval and will check again after [interval=${t}]`)}r.cnt+=1},s=setInterval(()=>{i()},t);i()})}let N=class{listeners={};on=(e,t)=>((this.listeners[e]||=[]).push(t),()=>this.off(e,t));off=(e,t)=>{this.listeners[e]=this.listeners[e]?.filter(r=>r!==t)};emit=async(e,...t)=>{for(const r of this.listeners[e]??[])await r(...t)};emitParallel=async(e,...t)=>{await Promise.all((this.listeners[e]??[]).map(r=>r(...t)))};emitSafe=async(e,...t)=>{for(const r of this.listeners[e]??[])try{await r(...t)}catch(l){this.listeners.error?.forEach(i=>i(l))}}};const w=()=>new N;class z{startTime;endTime;isRunning;constructor(){this.startTime=0,this.endTime=0,this.isRunning=!1}start(){if(this.isRunning)throw new Error("Benchmark has already started.");this.startTime=performance.now(),this.isRunning=!0}stop(){if(!this.isRunning)throw new Error("Benchmark hasn't started.");this.endTime=performance.now(),this.isRunning=!1}result(){if(this.isRunning)throw new Error("Benchmark is still running.");return{time_taken_ms:(this.endTime-this.startTime).toFixed(4)}}}console.log("content-engine-lib");let h={lib:{inbuilt_lib:[],l:{},set:async e=>{const t=e?.lib||[];for(const[r,l]of t.entries()){const i=l,s=`${i.name}:${e.run_from}`,d=`${e.run_from}_src`;let o=i[d];const m=`${e.run_from}_src`;let n=e?.lazy_lib?.[m]||null;if(n&&(n=n.replace("{*}",`${i.name}`)),console.log(`_lazy_src: ${n}`),console.log(`_src: ${o}`),h.lib.l.hasOwnProperty(`${s}`)==!1){if(/^[a-zA-Z0-9]/.test(o)&&o.includes("/")==!1&&h.lib.inbuilt_lib.indexOf(`${i.name}`)===-1)if(n)o=n;else throw`[lib-name=${i.name},lib-src=${o}] not allowed or available in in-build mode. Need to use lazy-lib config.`;if(o.startsWith("./")||o.startsWith("../")){const a=await import(`${o}`);h.lib.l[`${s}`]={lib:a,src:o}}if(o.startsWith("http://")||o.startsWith("https://")){const a=await import(`${o}`);h.lib.l[`${s}`]={lib:a,src:o}}}}console.log(await h.lib.get_all({}))},get:async e=>{let t=null;const r=`${e.name}:${e.run_from}`;return h.lib.l.hasOwnProperty(`${r}`)==!1&&await h.lib.set({lib:[{renderer_src:e.name,hydrator_src:e.name,editor_src:e.name,name:e.name}],run_from:e.run_from,lazy_lib:e.lazy_lib}),t=h.lib.l[`${r}`],t},get_all:async e=>h.lib.l},path:{set:e=>{let t="",r="";const l=e.src.split("/");if(e.src.indexOf("://localhost")!==-1||e.src.indexOf("://127.0.0.1")!==-1||(r="/dist"),l.indexOf(e.type)!==-1)for(const[i,s]of l.entries()){let d=i==0?"":"/";if(t+=`${d}${s}`,s==e.type)return`${t}${r}${e.name}`}else for(const[i,s]of l.entries()){let d=i==0?"":"/";if(t+=`${d}${s}`,s=="src")return`${t}${r}${e.name}`}return`${t}${r}${e.name}`}}};const T=w(),I=w(),O=T.on,P=T.emit,C=I.emit,S=I.on,j=async e=>{const t=await v();return await h.lib.set({lib:e.lib,run_from:"renderer",lazy_lib:e.lazy_lib}),{set:async r=>{console.log("--renderer [set]");const l=new z;l.start();let i=r.data?.value?.l||r.data.l,s={r:"",style:"",head:"",benchmark:null};return await(async()=>{for(const d of i){const o=await await h.lib.get({name:d.type,run_from:"renderer",lazy_lib:e.lazy_lib}),m=await(await o.lib.index({f:{name:n=>t.f.name({id:d.id,name:n}),get_lib:async n=>await await h.lib.get({name:n.name,run_from:n.run_from,lazy_lib:e.lazy_lib}),set_theme:async n=>await(await k()).set(n),path:n=>h.path.set({src:o.src,type:d.type,name:n}),uuid:()=>b().set(),wait_until:x}})).set({data:{curr:d}});s.r+=m?.r||"",s.style+=m?.style||"",s.head+=m?.head||""}})(),l.stop(),s.benchmark=l.result(),s}}},A=async e=>{const t=await v();return await h.lib.set({lib:e.lib,run_from:"hydrator",lazy_lib:e.lazy_lib}),{set:async r=>{console.log("--hydrator [set]");const l=new z;l.start();let i={r:"",style:""},s={style_id:`${b().set()}_stl`},d=r.data?.value?.l||r.data.l;const o=async()=>{for(const m of d){const n=await await h.lib.get({name:m.type,run_from:"hydrator",lazy_lib:e.lazy_lib}),a=n.lib,f=w(),c=f.on,_=await(await a.index({my:{},f:{name:u=>t.f.name({id:m.id,name:u}),get_lib:async u=>await await h.lib.get({name:u.name,run_from:u.run_from,lazy_lib:e.lazy_lib}),set_theme:async u=>await(await k()).set(u),path:u=>h.path.set({src:n.src,type:m.type,name:u}),uuid:()=>b().set(),wait_until:x,call:C,listen:c,new_emitter:()=>w()}})).set({data:{curr:m}});O("msg",async u=>{try{if(Object.keys(u.where||{}).length==0){await f.emit("msg",u);return}}catch{}try{if(m?.[u.where?.key||""]==u.where?.value){await f.emit("msg",u);return}}catch{}}),i.style+=_.style}};await x(()=>document.readyState==="complete"||typeof window<"u",50),await o();try{(m=>{const n=document.getElementById(`${s.style_id}`);n&&n.remove();const a=document.createElement("style");a.id=`${s.style_id}`,a.innerHTML=`${i.style}`,m.appendChild(a)})(document.head)}catch(m){console.log(`${m}, Failed to set style..`)}return l.stop(),{benchmark:l.result()}}}},M={key:0},B=["innerHTML"],L=y.defineComponent({__name:"index",props:{_p:{},_$p:{}},setup(e){const t=y.ref(null),r=y.ref("Ni"),l=y.ref(0),i=y.ref(20),s={url:"https://fastapi.dryutil.1mn.io/client/api/i/ona/product_dir?typ=get_product_list",token:"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImYwZTNlMDRiLTVkNDAtNDg1ZS05OGU4LWEzOTI3NWU3MzM0OCIsInNlY3VyaXR5Ijp7InBhcnR5IjpbInBhcnR5XzEiLCJwYXJ0eV8yIl19LCJzdWIiOiJmMGUzZTA0Yi01ZDQwLTQ4NWUtOThlOC1hMzkyNzVlNzMzNDgiLCJpYXQiOjE3NjU4MTI4Mjh9.OoClnPtlxI71L-e555nbNSmenmGufxewp78SlmdZCNxeuauXao5RRvqwOKQ77SJFqJXk0ng6GZ7VOgYECdEf-3k1UGX7w1NE_D5A6SP3UkVsSG8orYACFuvTyesbFwkpnEhdu0PBd6n8wuLkgU6nZ1bLDzKVg1zd8fFeJrwmUqk"};async function d(n,a=1,f=20){try{const c=await fetch(s.url,{method:"POST",headers:{accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${s.token}`},body:JSON.stringify({q:n,page:a,per_page:f})});if(!c.ok)throw new Error(`API error: ${c.status}`);return await c.json()}catch(c){return console.error("Error fetching product list:",c),null}}function o(n){return!n||!n.success||!n.data||!n.data.products?[]:n.data.products.map((a,f)=>{const c=Math.min(...a.variant_prices),_=Math.max(...a.variant_prices),u=c===_?`₹${c}`:`₹${c} - ₹${_}`;return{id:a.id,sku:`SKU-${a.id.slice(0,8)}`,name:`<a href="#" class="text-blue-600 hover:underline font-medium">${a.title}</a>`,brand:`<span class="font-semibold text-gray-700">${a.brand}</span>`,category:a.category.join(", "),price:u,stock:a.variant_prices.length,rating:a._relevance_score?(a._relevance_score*5).toFixed(1):"N/A",slug:`<span class="inline-flex items-center justify-center px-2 py-1 rounded text-xs font-bold border border-transparent bg-blue-100 text-blue-700 dark:bg-blue-500/10 dark:text-blue-400">${a.category[0]||"Product"}</span>`}})}async function m(n,a,f=1){const c=await d(a,f,i.value);if(c&&c.success){const _=o(c);try{if(!(_.length>0))throw new Error("no more data..")}catch{return}const{found:u,total_pages:p,search_time_ms:g}=c.data;n._$p.data.curr.data.table.rows=_,P("msg",{type:"load_more",_p:n._p,_$p:n._$p,custom:{searchText:a,page:f,totalPages:p,found:u},where:{key:"id",value:"3e1bc78c-104f-4f6f-aa87-75"}})}}return y.onMounted(()=>{(async()=>{let n="",a={l:[{id:"3e1bc78c-104f-4f6f-aa87-75",type:"table",slug:"table",data:{theme:e._$p.data.curr.data.theme,foo:{txt:""},config:{search:{placeholder:"Search Products (e.g., Nike shirts, Adidas shoes)...",field:"name"},filter:{label:"All Categories",field:"category"},filterOptions:["Men","Women","Footwear","Apparel","Accessories"]},table:{columns:[{title:"Product ID",field:"id",width:150,headerSort:!1},{title:"Product Name",field:"name",widthGrow:3,minWidth:250,formatter:"html"},{title:"Brand",field:"brand",widthGrow:1,minWidth:120,formatter:"html"},{title:"Category",field:"category",widthGrow:1,minWidth:150},{title:"Price",field:"price",width:140,hozAlign:"right"},{title:"Type",field:"slug",formatter:"html",widthGrow:1,minWidth:110,hozAlign:"center"}],rows:[]}}}]};const f={lib:[],lazy_lib:{renderer_src:"https://cdn.jsdelivr.net/gh/1mn-io/mn-app/modules/{*}/dist/renderer.es.js",hydrator_src:"https://cdn.jsdelivr.net/gh/1mn-io/mn-app/modules/{*}/dist/hydrator.es.js",editor_src:"https://cdn.jsdelivr.net/gh/1mn-io/mn-app/modules/{*}/dist/editor.es.js"}},c=await j(f),_=await A(f);(async()=>S("msg",async p=>{console.log("[ce_listen]",p),p.type=="load_more"&&p._$p.data.curr.id=="3e1bc78c-104f-4f6f-aa87-75"&&(l.value+=1,m(p,r.value,l.value))}))(),await(async()=>{const p=await c.set({data:a});t.value=p.r||"",n=p.style;const g=document.createElement("style");document.head.appendChild(g),g.innerHTML=n,setTimeout(async()=>{const $=await _.set({data:a});console.log($)},20)})()})()}),(n,a)=>t.value?(y.openBlock(),y.createElementBlock("div",M,[y.createBaseVNode("div",{innerHTML:t.value},null,8,B)])):y.createCommentVNode("",!0)}}),E=async e=>({set:async t=>{console.log(`--hydrator [${t.data.curr.type}]`);const r={_p:e,_$p:t},l=y.createApp(L,r),i={r:"",style:"",evt:{change:()=>{e.f.call("msg",{type:"change",_p:e,_$p:t,custom:{}})}}},s=document.getElementById(e.f.name("vue-root"));return l.mount(s),i}});exports.hydrator=E;exports.index=E;
