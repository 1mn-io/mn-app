"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const m=require("./runtime-dom.esm-bundler-pS1WmCCX.cjs"),b=()=>({set:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}),k=async()=>({f:{name:e=>`${e.name}${e.id}`}}),z=async()=>({set:async e=>{console.log("--theme");try{if(!e.el_id)throw new Error("[el_id] is required");const t=e.name,a=document.getElementById(e.el_id);if(!a)throw new Error("[el_id] is invalid");(i=>{const l=s=>{(u=>{const o=u.getAttribute("data-ce");if(!o)return;const c=JSON.parse(o).filter(r=>r?.k.startsWith("t-"));if(c.length!=0)for(const r of c){const n=r.k,y=r.v.split(" ");if(n==`t-${t}-class`)for(const d of y)u.classList.add(d);else for(const d of y)u.classList.remove(d)}})(s)};for(const s of i.getElementsByTagName("*"))l(s);l(i)})(a)}catch(t){const a=`err: [theme] ${t}`;throw console.log(a),a}}});function x(e,t=1e3){let a={cnt:0};return new Promise(i=>{const l=()=>{console.log(`[setInterval] is running.. [count=${a.cnt}]`);try{e()&&(clearInterval(s),i())}catch{console.log(`warn: [wait_until] ignoring the exception in setInterval and will check again after [interval=${t}]`)}a.cnt+=1},s=setInterval(()=>{l()},t);l()})}let O=class{listeners={};on=(e,t)=>((this.listeners[e]||=[]).push(t),()=>this.off(e,t));off=(e,t)=>{this.listeners[e]=this.listeners[e]?.filter(a=>a!==t)};emit=async(e,...t)=>{for(const a of this.listeners[e]??[])await a(...t)};emitParallel=async(e,...t)=>{await Promise.all((this.listeners[e]??[]).map(a=>a(...t)))};emitSafe=async(e,...t)=>{for(const a of this.listeners[e]??[])try{await a(...t)}catch(i){this.listeners.error?.forEach(l=>l(i))}}};const g=()=>new O;class T{startTime;endTime;isRunning;constructor(){this.startTime=0,this.endTime=0,this.isRunning=!1}start(){if(this.isRunning)throw new Error("Benchmark has already started.");this.startTime=performance.now(),this.isRunning=!0}stop(){if(!this.isRunning)throw new Error("Benchmark hasn't started.");this.endTime=performance.now(),this.isRunning=!1}result(){if(this.isRunning)throw new Error("Benchmark is still running.");return{time_taken_ms:(this.endTime-this.startTime).toFixed(4)}}}console.log("content-engine-lib");let f={lib:{inbuilt_lib:[],l:{},set:async e=>{const t=e?.lib||[];for(const[a,i]of t.entries()){const l=i,s=`${l.name}:${e.run_from}`,u=`${e.run_from}_src`;let o=l[u];const c=`${e.run_from}_src`;let r=e?.lazy_lib?.[c]||null;if(r&&(r=r.replace("{*}",`${l.name}`)),console.log(`_lazy_src: ${r}`),console.log(`_src: ${o}`),f.lib.l.hasOwnProperty(`${s}`)==!1){if(/^[a-zA-Z0-9]/.test(o)&&o.includes("/")==!1&&f.lib.inbuilt_lib.indexOf(`${l.name}`)===-1)if(r)o=r;else throw`[lib-name=${l.name},lib-src=${o}] not allowed or available in in-build mode. Need to use lazy-lib config.`;if(o.startsWith("./")||o.startsWith("../")){const n=await import(`${o}`);f.lib.l[`${s}`]={lib:n,src:o}}if(o.startsWith("http://")||o.startsWith("https://")){const n=await import(`${o}`);f.lib.l[`${s}`]={lib:n,src:o}}}}console.log(await f.lib.get_all({}))},get:async e=>{let t=null;const a=`${e.name}:${e.run_from}`;return f.lib.l.hasOwnProperty(`${a}`)==!1&&await f.lib.set({lib:[{renderer_src:e.name,hydrator_src:e.name,editor_src:e.name,name:e.name}],run_from:e.run_from,lazy_lib:e.lazy_lib}),t=f.lib.l[`${a}`],t},get_all:async e=>f.lib.l},path:{set:e=>{let t="",a="";const i=e.src.split("/");if(e.src.indexOf("://localhost")!==-1||e.src.indexOf("://127.0.0.1")!==-1||(a="/dist"),i.indexOf(e.type)!==-1)for(const[l,s]of i.entries()){let u=l==0?"":"/";if(t+=`${u}${s}`,s==e.type)return`${t}${a}${e.name}`}else for(const[l,s]of i.entries()){let u=l==0?"":"/";if(t+=`${u}${s}`,s=="src")return`${t}${a}${e.name}`}return`${t}${a}${e.name}`}}};const I=g(),N=g(),P=I.on,v=I.emit,B=N.emit,S=N.on,C=async e=>{const t=await k();return await f.lib.set({lib:e.lib,run_from:"renderer",lazy_lib:e.lazy_lib}),{set:async a=>{console.log("--renderer [set]"),a.return=a?.return||{},a.return.r=a?.return?.r||"full";const i=new T;i.start();let l=a.data?.value?.l||a.data.l,s={r:null,style:"",head:"",benchmark:null};return a.return.r=="full"?s.r="":s.r=[],await(async()=>{for(const u of l){const o=await await f.lib.get({name:u.type,run_from:"renderer",lazy_lib:e.lazy_lib}),c=await(await o.lib.index({f:{name:r=>t.f.name({id:u.id,name:r}),get_lib:async r=>await await f.lib.get({name:r.name,run_from:r.run_from,lazy_lib:e.lazy_lib}),set_theme:async r=>await(await z()).set(r),path:r=>f.path.set({src:o.src,type:u.type,name:r}),uuid:()=>b().set(),wait_until:x}})).set({data:{curr:u}});a?.return?.r=="full"?s.r+=c?.r||"":s.r.push(c?.r||""),s.style+=c?.style||"",s.head+=c?.head||""}})(),i.stop(),s.benchmark=i.result(),s}}},M=async e=>{const t=await k();return await f.lib.set({lib:e.lib,run_from:"hydrator",lazy_lib:e.lazy_lib}),{set:async a=>{console.log("--hydrator [set]");const i=new T;i.start();let l={r:"",style:""},s={style_id:`${b().set()}_stl`},u=a.data?.value?.l||a.data.l;const o=async()=>{for(const c of u){const r=await await f.lib.get({name:c.type,run_from:"hydrator",lazy_lib:e.lazy_lib}),n=r.lib,y=g(),d=y.on,_=await(await n.index({my:{},f:{name:h=>t.f.name({id:c.id,name:h}),get_lib:async h=>await await f.lib.get({name:h.name,run_from:h.run_from,lazy_lib:e.lazy_lib}),set_theme:async h=>await(await z()).set(h),path:h=>f.path.set({src:r.src,type:c.type,name:h}),uuid:()=>b().set(),wait_until:x,call:B,listen:d,new_emitter:()=>g()}})).set({data:{curr:c}});P("msg",async h=>{try{if(Object.keys(h.where||{}).length==0){await y.emit("msg",h);return}}catch{}try{if(c?.[h.where?.key||""]==h.where?.value){await y.emit("msg",h);return}}catch{}}),l.style+=_.style}};await x(()=>document.readyState==="complete"||typeof window<"u",50),await o();try{(c=>{const r=document.getElementById(`${s.style_id}`);r&&r.remove();const n=document.createElement("style");n.id=`${s.style_id}`,n.innerHTML=`${l.style}`,c.appendChild(n)})(document.head)}catch(c){console.log(`${c}, Failed to set style..`)}return i.stop(),{benchmark:i.result()}}}},j={key:0,class:"pb-3 pt-3 pl-3 pr-3 sticky top-0 bg-white z-10"},A=["innerHTML"],L={key:1},J=["innerHTML"],W=m.defineComponent({__name:"index",props:{_p:{},_$p:{}},setup(e){m.ref(null);const t=m.ref("Ni"),a=m.ref(0),i=m.ref(20),l=m.ref({html:{table:null,search_panel:null}}),s={url:"https://fastapi.dryutil.1mn.io/client/api/i/ona/product_dir?typ=get_product_list",token:"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImYwZTNlMDRiLTVkNDAtNDg1ZS05OGU4LWEzOTI3NWU3MzM0OCIsInNlY3VyaXR5Ijp7InBhcnR5IjpbInBhcnR5XzEiLCJwYXJ0eV8yIl19LCJzdWIiOiJmMGUzZTA0Yi01ZDQwLTQ4NWUtOThlOC1hMzkyNzVlNzMzNDgiLCJpYXQiOjE3NjU4MTI4Mjh9.OoClnPtlxI71L-e555nbNSmenmGufxewp78SlmdZCNxeuauXao5RRvqwOKQ77SJFqJXk0ng6GZ7VOgYECdEf-3k1UGX7w1NE_D5A6SP3UkVsSG8orYACFuvTyesbFwkpnEhdu0PBd6n8wuLkgU6nZ1bLDzKVg1zd8fFeJrwmUqk"};async function u(r,n=1,y=20){try{const d=await fetch(s.url,{method:"POST",headers:{accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${s.token}`},body:JSON.stringify({q:r,page:n,per_page:y})});if(!d.ok)throw new Error(`API error: ${d.status}`);return await d.json()}catch(d){return console.error("Error fetching product list:",d),null}}function o(r){return!r||!r.success||!r.data||!r.data.products?[]:r.data.products.map((n,y)=>{const d=Math.min(...n.variant_prices),_=Math.max(...n.variant_prices),h=d===_?`₹${d}`:`₹${d} - ₹${_}`;return{id:n.id,sku:`SKU-${n.id.slice(0,8)}`,name:`<a href="#" class="text-blue-600 hover:underline font-medium">${n.title}</a>`,brand:`<span class="font-semibold text-gray-700">${n.brand}</span>`,category:n.category.join(", "),price:h,stock:n.variant_prices.length,rating:n._relevance_score?(n._relevance_score*5).toFixed(1):"N/A",slug:`<span class="inline-flex items-center justify-center px-2 py-1 rounded text-xs font-bold border border-transparent bg-blue-100 text-blue-700 dark:bg-blue-500/10 dark:text-blue-400">${n.category[0]||"Product"}</span>`}})}async function c(r,n,y=1){const d=await u(n,y,i.value);if(d&&d.success){const _=o(d);try{if(!(_.length>0))throw new Error("no more data..")}catch{return}const{found:h,total_pages:p,search_time_ms:w}=d.data;r._$p.data.curr.data.table.rows=_,v("msg",{type:"load_more",_p:r._p,_$p:r._$p,custom:{searchText:n,page:y,totalPages:p,found:h},where:{key:"id",value:"3e1bc78c-104f-4f6f-aa87-75"}})}}return m.onMounted(()=>{(async()=>{let r="",n={l:[{id:"3e1bc78c-104f-4f6f-aa87-75",type:"table",slug:"table",data:{theme:e._$p.data.curr.data.theme,foo:{txt:""},config:{search:{placeholder:"Search Products (e.g., Nike shirts, Adidas shoes)...",field:"name"},filter:{label:"All Categories",field:"category"},filterOptions:["Men","Women","Footwear","Apparel","Accessories"]},table:{columns:[{title:"Product ID",field:"id",width:150,headerSort:!1},{title:"Product Name",field:"name",widthGrow:3,minWidth:250,formatter:"html"},{title:"Brand",field:"brand",widthGrow:1,minWidth:120,formatter:"html"},{title:"Category",field:"category",widthGrow:1,minWidth:150},{title:"Price",field:"price",width:140,hozAlign:"right"},{title:"Type",field:"slug",formatter:"html",widthGrow:1,minWidth:110,hozAlign:"center"}],rows:[]}}},{id:"3e1bc78c-aa87-search-panel",type:"search_panel",slug:"search_panel",data:{data:"",placeholder:"Search..",show_sugg:!1,size:"sm",class:"p-1 max-w-lg",sugg:[],map:{title:"title",label:"type"}}}]};const y={lib:[],lazy_lib:{renderer_src:"https://cdn.jsdelivr.net/gh/1mn-io/mn-app@latest/modules/{*}/dist/renderer.es.js",hydrator_src:"https://cdn.jsdelivr.net/gh/1mn-io/mn-app@latest/modules/{*}/dist/hydrator.es.js",editor_src:"https://cdn.jsdelivr.net/gh/1mn-io/mn-app@latest/modules/{*}/dist/editor.es.js"}},d=await C(y),_=await M(y);(async()=>S("msg",async p=>{if(console.log("[ce_listen]",p),p.type=="load_more"&&p._$p.data.curr.id=="3e1bc78c-104f-4f6f-aa87-75"&&(a.value+=1,c(p,t.value,a.value)),p.type=="search:query"&&p._$p.data.curr.id=="3e1bc78c-aa87-search-panel"){v("msg",{type:"remove_all_rows",custom:{},where:{key:"id",value:"3e1bc78c-104f-4f6f-aa87-75"}}),t.value=p._p.query;let w=JSON.parse(JSON.stringify({data:{curr:n.l[0]}}));c({_$p:w,_p:e._p},t.value,a.value),console.log()}}))(),await(async()=>{const p=await d.set({data:n,return:{r:"chunk"}});r=p.style,l.value.html.table=p.r[0]||"",l.value.html.search_panel=p.r[1]||"";const w=document.createElement("style");document.head.appendChild(w),w.innerHTML=r,setTimeout(async()=>{const $=await _.set({data:n});console.log($)},20)})()})()}),(r,n)=>(m.openBlock(),m.createElementBlock(m.Fragment,null,[l.value.html.search_panel?(m.openBlock(),m.createElementBlock("div",j,[m.createBaseVNode("div",null,[m.createBaseVNode("div",{innerHTML:l.value.html.search_panel},null,8,A)])])):m.createCommentVNode("",!0),l.value.html.table?(m.openBlock(),m.createElementBlock("div",L,[m.createBaseVNode("div",{innerHTML:l.value.html.table},null,8,J)])):m.createCommentVNode("",!0)],64))}}),E=async e=>({set:async t=>{console.log(`--hydrator [${t.data.curr.type}]`);const a={_p:e,_$p:t},i=m.createApp(W,a),l={r:"",style:"",evt:{change:()=>{e.f.call("msg",{type:"change",_p:e,_$p:t,custom:{}})}}},s=document.getElementById(e.f.name("vue-root"));return i.mount(s),l}});exports.hydrator=E;exports.index=E;
