"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const n=require("./runtime-dom.esm-bundler-pS1WmCCX.cjs"),p=require("content-engine-lib"),v={key:0},I=["innerHTML"],x=n.defineComponent({__name:"index",props:{_p:{},_$p:{}},setup(i){const c=n.ref(null),h=n.ref("Ni"),l=n.ref(0),m=n.ref(20),d={url:"https://fastapi.dryutil.1mn.io/client/api/i/ona/product_dir?typ=get_product_list",token:"eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImYwZTNlMDRiLTVkNDAtNDg1ZS05OGU4LWEzOTI3NWU3MzM0OCIsInNlY3VyaXR5Ijp7InBhcnR5IjpbInBhcnR5XzEiLCJwYXJ0eV8yIl19LCJzdWIiOiJmMGUzZTA0Yi01ZDQwLTQ4NWUtOThlOC1hMzkyNzVlNzMzNDgiLCJpYXQiOjE3NjU4MTI4Mjh9.OoClnPtlxI71L-e555nbNSmenmGufxewp78SlmdZCNxeuauXao5RRvqwOKQ77SJFqJXk0ng6GZ7VOgYECdEf-3k1UGX7w1NE_D5A6SP3UkVsSG8orYACFuvTyesbFwkpnEhdu0PBd6n8wuLkgU6nZ1bLDzKVg1zd8fFeJrwmUqk"};async function f(r,e=1,o=20){try{const t=await fetch(d.url,{method:"POST",headers:{accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${d.token}`},body:JSON.stringify({q:r,page:e,per_page:o})});if(!t.ok)throw new Error(`API error: ${t.status}`);return await t.json()}catch(t){return console.error("Error fetching product list:",t),null}}function w(r){return!r||!r.success||!r.data||!r.data.products?[]:r.data.products.map((e,o)=>{const t=Math.min(...e.variant_prices),s=Math.max(...e.variant_prices),u=t===s?`₹${t}`:`₹${t} - ₹${s}`;return{id:e.id,sku:`SKU-${e.id.slice(0,8)}`,name:`<a href="#" class="text-blue-600 hover:underline font-medium">${e.title}</a>`,brand:`<span class="font-semibold text-gray-700">${e.brand}</span>`,category:e.category.join(", "),price:u,stock:e.variant_prices.length,rating:e._relevance_score?(e._relevance_score*5).toFixed(1):"N/A",slug:`<span class="inline-flex items-center justify-center px-2 py-1 rounded text-xs font-bold border border-transparent bg-blue-100 text-blue-700 dark:bg-blue-500/10 dark:text-blue-400">${e.category[0]||"Product"}</span>`}})}async function b(r,e,o=1){const t=await f(e,o,m.value);if(t&&t.success){const s=w(t);try{if(!(s.length>0))throw new Error("no more data..")}catch{return}const{found:u,total_pages:a,search_time_ms:_}=t.data;r._$p.data.curr.data.table.rows=s,p.ce_call("msg",{type:"load_more",_p:r._p,_$p:r._$p,custom:{searchText:e,page:o,totalPages:a,found:u},where:{key:"id",value:"3e1bc78c-104f-4f6f-aa87-75"}})}}return n.onMounted(()=>{(async()=>{let r="",e={l:[{id:"3e1bc78c-104f-4f6f-aa87-75",type:"table",slug:"table",data:{theme:i._$p.data.curr.data.theme,foo:{txt:""},config:{search:{placeholder:"Search Products (e.g., Nike shirts, Adidas shoes)...",field:"name"},filter:{label:"All Categories",field:"category"},filterOptions:["Men","Women","Footwear","Apparel","Accessories"]},table:{columns:[{title:"Product ID",field:"id",width:150,headerSort:!1},{title:"Product Name",field:"name",widthGrow:3,minWidth:250,formatter:"html"},{title:"Brand",field:"brand",widthGrow:1,minWidth:120,formatter:"html"},{title:"Category",field:"category",widthGrow:1,minWidth:150},{title:"Price",field:"price",width:140,hozAlign:"right"},{title:"Type",field:"slug",formatter:"html",widthGrow:1,minWidth:110,hozAlign:"center"}],rows:[]}}}]};const o={lib:[],lazy_lib:{renderer_src:"https://cdn.jsdelivr.net/gh/1mn-io/mn-app/modules/{*}/dist/renderer.es.js",hydrator_src:"https://cdn.jsdelivr.net/gh/1mn-io/mn-app/modules/{*}/dist/hydrator.es.js",editor_src:"https://cdn.jsdelivr.net/gh/1mn-io/mn-app/modules/{*}/dist/editor.es.js"}},t=await p.ce_renderer(o),s=await p.ce_hydrator(o);(async()=>p.ce_listen("msg",async a=>{console.log("[ce_listen]",a),a.type=="load_more"&&a._$p.data.curr.id=="3e1bc78c-104f-4f6f-aa87-75"&&(l.value+=1,b(a,h.value,l.value))}))(),await(async()=>{const a=await t.set({data:e});c.value=a.r||"",r=a.style;const _=document.createElement("style");document.head.appendChild(_),_.innerHTML=r,setTimeout(async()=>{const y=await s.set({data:e});console.log(y)},20)})()})()}),(r,e)=>c.value?(n.openBlock(),n.createElementBlock("div",v,[n.createBaseVNode("div",{innerHTML:c.value},null,8,I)])):n.createCommentVNode("",!0)}}),g=async i=>({set:async c=>{console.log(`--hydrator [${c.data.curr.type}]`);const h={_p:i,_$p:c},l=n.createApp(x,h),m={r:"",style:"",evt:{change:()=>{i.f.call("msg",{type:"change",_p:i,_$p:c,custom:{}})}}},d=document.getElementById(i.f.name("vue-root"));return l.mount(d),m}});exports.hydrator=g;exports.index=g;
