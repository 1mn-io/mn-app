"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const n=require("./runtime-dom.esm-bundler-BPdTYN4R.cjs");const V=n.makeMap(",key,ref,innerHTML,textContent,ref_key,ref_for");function B(e,r){let t="";for(const s in e){if(V(s)||n.isOn(s)||r==="textarea"&&s==="value")continue;const o=e[s];s==="class"?t+=` class="${H(o)}"`:s==="style"?t+=` style="${x(o)}"`:s==="className"?t+=` class="${String(o)}"`:t+=N(s,o,r)}return t}function N(e,r,t){if(!n.isRenderableAttrValue(r))return"";const s=t&&(t.indexOf("-")>0||n.isSVGTag(t))?e:n.propsToAttrMap[e]||e.toLowerCase();return n.isBooleanAttr(s)?n.includeBooleanAttr(r)?` ${s}`:"":n.isSSRSafeAttrName(s)?r===""?` ${s}`:` ${s}="${n.escapeHtml(r)}"`:(console.warn(`[@vue/server-renderer] Skipped rendering unsafe attribute name: ${s}`),"")}function H(e){return n.escapeHtml(n.normalizeClass(e))}function x(e){if(!e)return"";if(n.isString(e))return n.escapeHtml(e);const r=n.normalizeStyle(P(e));return n.escapeHtml(n.stringifyStyle(r))}function P(e){if(!n.isArray(e)&&n.isObject(e)){const r={};for(const t in e)t.startsWith(":--")?r[t.slice(1)]=n.normalizeCssVarValue(e[t]):r[t]=e[t];return r}return e}function O(e,r,t,s,o){e("<!--teleport start-->");const i=o.appContext.provides[n.ssrContextKey],l=i.__teleportBuffers||(i.__teleportBuffers={}),f=l[t]||(l[t]=[]),c=f.length;let p;if(s)r(e),p="<!--teleport start anchor--><!--teleport anchor-->";else{const{getBuffer:u,push:a}=T();a("<!--teleport start anchor-->"),r(a),a("<!--teleport anchor-->"),p=u()}f.splice(c,0,p),e("<!--teleport end-->")}{const e=n.getGlobalThis(),r=(t,s)=>{let o;return(o=e[t])||(o=e[t]=[]),o.push(s),i=>{o.length>1?o.forEach(l=>l(i)):o[0](i)}};r("__VUE_INSTANCE_SETTERS__",t=>t),r("__VUE_SSR_SETTERS__",t=>t)}function k(e,r){throw new Error("On-the-fly template compilation is not supported in the ESM build of @vue/server-renderer. All templates must be pre-compiled into render functions.")}const{createComponentInstance:v,setCurrentRenderingInstance:y,setupComponent:E,renderComponentRoot:h,normalizeVNode:w}=n.ssrUtils;function T(){let e=!1;const r=[];return{getBuffer(){return r},push(t){const s=n.isString(t);if(e&&s){r[r.length-1]+=t;return}r.push(t),e=s,(n.isPromise(t)||n.isArray(t)&&t.hasAsync)&&(r.hasAsync=!0)}}}function $(e,r=null,t){const s=e.component=v(e,r,null),o=E(s,!0),i=n.isPromise(o);let l=s.sp;return i||l?Promise.resolve(o).then(()=>{if(i&&(l=s.sp),l)return Promise.all(l.map(c=>c.call(s.proxy)))}).catch(n.NOOP).then(()=>S(s,t)):S(s,t)}function S(e,r){const t=e.type,{getBuffer:s,push:o}=T();if(n.isFunction(t)){let i=h(e);if(!t.props)for(const l in e.attrs)l.startsWith("data-v-")&&((i.props||(i.props={}))[l]="");_(o,e.subTree=i,e,r)}else{(!e.render||e.render===n.NOOP)&&!e.ssrRender&&!t.ssrRender&&n.isString(t.template)&&(t.ssrRender=k(t.template));const i=e.ssrRender||t.ssrRender;if(i){let l=e.inheritAttrs!==!1?e.attrs:void 0,f=!1,c=e;for(;;){const u=c.vnode.scopeId;u&&(f||(l={...l},f=!0),l[u]="");const a=c.parent;if(a&&a.subTree&&a.subTree===c.vnode)c=a;else break}if(r){f||(l={...l});const u=r.trim().split(" ");for(let a=0;a<u.length;a++)l[u[a]]=""}const p=y(e);try{i(e.proxy,o,e,l,e.props,e.setupState,e.data,e.ctx)}finally{y(p)}}else e.render&&e.render!==n.NOOP?_(o,e.subTree=h(e),e,r):(t.name||t.__file,o("<!---->"))}return s()}function _(e,r,t,s){const{type:o,shapeFlag:i,children:l,dirs:f,props:c}=r;switch(f&&(r.props=L(r,c,f)),o){case n.Text:e(n.escapeHtml(l));break;case n.Comment:e(l?`<!--${n.escapeHtmlComment(l)}-->`:"<!---->");break;case n.Static:e(l);break;case n.Fragment:r.slotScopeIds&&(s=(s?s+" ":"")+r.slotScopeIds.join(" ")),e("<!--[-->"),g(e,l,t,s),e("<!--]-->");break;default:i&1?M(e,r,t,s):i&6?e($(r,t,s)):i&64?U(e,r,t,s):i&128&&_(e,r.ssContent,t,s)}}function g(e,r,t,s){for(let o=0;o<r.length;o++)_(e,w(r[o]),t,s)}function M(e,r,t,s){const o=r.type;let{props:i,children:l,shapeFlag:f,scopeId:c}=r,p=`<${o}`;i&&(p+=B(i,o)),c&&(p+=` ${c}`);let u=t,a=r;for(;u&&a===u.subTree;)a=u.vnode,a.scopeId&&(p+=` ${a.scopeId}`),u=u.parent;if(s&&(p+=` ${s}`),e(p+">"),!n.isVoidTag(o)){let d=!1;i&&(i.innerHTML?(d=!0,e(i.innerHTML)):i.textContent?(d=!0,e(n.escapeHtml(i.textContent))):o==="textarea"&&i.value&&(d=!0,e(n.escapeHtml(i.value)))),d||(f&8?e(n.escapeHtml(l)):f&16&&g(e,l,t,s)),e(`</${o}>`)}}function L(e,r,t){const s=[];for(let o=0;o<t.length;o++){const i=t[o],{dir:{getSSRProps:l}}=i;if(l){const f=l(i,e);f&&s.push(f)}}return n.mergeProps(r||{},...s)}function U(e,r,t,s){const o=r.props&&r.props.to,i=r.props&&r.props.disabled;if(!o)return[];if(!n.isString(o))return[];O(e,l=>{g(l,r.children,t,s)},o,i||i==="",t)}const{isVNode:z}=n.ssrUtils;function m(e,r,t){if(!e.hasAsync)return r+b(e);let s=r;for(let o=t;o<e.length;o+=1){const i=e[o];if(n.isString(i)){s+=i;continue}if(n.isPromise(i))return i.then(f=>(e[o]=f,m(e,s,o)));const l=m(i,s,0);if(n.isPromise(l))return l.then(f=>(e[o]=f,m(e,"",o)));s=l}return s}function C(e){return m(e,"",0)}function b(e){let r="";for(let t=0;t<e.length;t++){let s=e[t];n.isString(s)?r+=s:r+=b(s)}return r}async function R(e,r={}){if(z(e))return R(n.createApp({render:()=>e}),r);const t=n.createVNode(e._component,e._props);t.appContext=e._context,e.provide(n.ssrContextKey,r);const s=await $(t),o=await C(s);if(await D(r),r.__watcherHandles)for(const i of r.__watcherHandles)i();return o}async function D(e){if(e.__teleportBuffers){e.teleports=e.teleports||{};for(const r in e.__teleportBuffers)e.teleports[r]=await C(await Promise.all([e.__teleportBuffers[r]]))}}n.initDirectivesForSSR();const F=n.defineComponent({__name:"index",props:{_p:{},_$p:{},_$cb:{}},setup(e){return(r,t)=>null}}),A=async e=>({set:async(r,t)=>{console.log(`--renderer [${r.data.curr.type}]`);const s={_p:e,_$p:r,_$cb:t},o=n.createSSRApp(F,s);return{r:`
                 <div>
                    ${await R(o)}
                    <div id="${e.f.name("vue-root")}"></div>
                    <div id="app"></div>

                  </div>
                `,style:(()=>{let f="";return f=`
                .${e.f.name("text")} {
                   background: transparent;
                }
                `,f})()}}});exports.index=A;exports.renderer=A;
